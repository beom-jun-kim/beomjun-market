// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  url          = env("DATABASE_URL")
  provider     = "mysql"
  relationMode = "prisma"
}

generator client {
  provider = "prisma-client-js"
}

model User {

  // @ : 식별자
  // @default(autoincrement()) : 기본설정 (자동으로 증가하게)
  id Int @id @default(autoincrement())

  // BigInt : 좀 더 긴 정수( ex) input에 입력되는 전화번호 ) 사용 가능, string으로도 가능
  phone  Int? @unique
  email  String? @unique
  name   String
  avatar String?

  // now() : 날짜를 가져옴
  created DateTime @default(now())

  // updatedAt : 유저가 업데이트 될 때마다 field 변화 인지
  updated DateTime @updatedAt()
  tokens   Token[]
}

// 추가후 npx prisma db push : db를 수정하는 동시에 prisma client를 만들어줌
model Token {
  id Int @id @default(autoincrement())

  // 중요! schema에서 정한 name이랑 넘겨주는 데이터 name이랑 같아야함 (payload)
  payload String @unique

  // 자동완성되지 않을 때 콘솔창에 "npx prisma foirmat"
  // 네임스페이스 형태로 데이터 접근가능
  // onDelete : 삭제 되었을때 동작
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  // db에 실제 user전체 데이터가 들어가지 않아서
  userId  Int
  created DateTime @default(now())
  updated DateTime @updatedAt()
    
  @@index([userId])
}


// 서버연결 안될시 : 서버 종료후 , connet명령어 후 push 명령어 후 서버시작